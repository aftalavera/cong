<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="application/xhtml+xml; charset=utf-8" />
<title>Senador Resumen</title>
<meta http-equiv="X-UA-Compatible" content="IE=EmulateIE7" />
<script type="text/javascript" src="{page:pathToRoot}script.js"></script>
<link rel="stylesheet" type="text/css" href="{page:pathToRoot}style.css" />
<!--[if IE 6]><link rel="stylesheet" href="{page:pathToRoot}style.ie6.css" type="text/css" media="screen" /><![endif]-->
<!--[if IE 7]><LINK 
rel=stylesheet type=text/css href="{page:pathToRoot}style.ie7.css" media=screen><![endif]-->
<style>
    path:hover, polygon:hover {
        fill: gray;
    }
</style>      
<script language="JavaScript" type="text/javascript">
<!--//--><![CDATA[//><!--

//Begin CCS script
//Include Common JSFunctions @1-F6D184C6

//--><!]]>
</script>
<script language="JavaScript" src="ClientI18N.php?file=Functions.js&amp;locale={res:CCS_LocaleID}" type="text/javascript" charset="utf-8"></script>
<script language="JavaScript" type="text/javascript">
<!--//--><![CDATA[//><!--
//End Include Common JSFunctions

//SelectFormprovincia_OnChange @131-D58F10DC
function SelectFormprovincia_OnChange()
{
    var result = true;
//End SelectFormprovincia_OnChange

//Submit Form @235-5B2AE65E
    document.forms["SelectForm"].submit();
//End Submit Form

//Close SelectFormprovincia_OnChange @131-BC33A33A
    return result;
}
//End Close SelectFormprovincia_OnChange


//SelectFormButton_Delete_OnClick @134-0F56F3DD
function SelectFormButton_Delete_OnClick()
{
    disableValidation = true;
}
//End SelectFormButton_Delete_OnClick


//bind_events @1-86BB41EB
function bind_events() {
    if (functionExists("Header_bind_events")) Header_bind_events();
    if (functionExists("Footer_bind_events")) Footer_bind_events();
    addEventHandler("SelectFormprovincia", "change", SelectFormprovincia_OnChange);
    addEventHandler("SelectFormButton_Delete", "click", SelectFormButton_Delete_OnClick);
}
//End bind_events

window.onload = bind_events; //Assign bind_events @1-19F7B649

//End CCS script

//--><!]]>
</script>
</head>
<body>
{Header} 

<h1>SENADO</h1>

<h2 class="art-postheader">Mapa de Provincias</h2>
<!-- <embed src="./svg/provincias.svg" width="100%" height="400" type="image/svg+xml" style="border: .001cm solid black"/> -->
<div id="map"></div>

<!-- BEGIN Record SelectForm -->
<form id="SelectForm" method="post" name="{HTMLFormName}" action="{Action}">
  <table>
    <!-- BEGIN Error -->
    <tr>
      <td colspan="2">{Error}</td> 
    </tr>
 <!-- END Error -->
    <tr>
      <td><label for="SelectFormprovincia"><strong>Seleccione un Provincia:</strong>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</label></td> 
      <td>
        <select id="SelectFormprovincia" name="{provincia_Name}">
          <option selected="selected" value="">Select Value</option>
 {provincia_Options} 
        </select>
 </td> 
    </tr>
 
    <tr>
      <td colspan="2" align="right">
        <!-- BEGIN Button Button_Insert --><input id="SelectFormButton_Insert" value="Add" alt="Add" type="submit" name="{Button_Name}" /><!-- END Button Button_Insert -->
        <!-- BEGIN Button Button_Update --><input id="SelectFormButton_Update" value="Submit" alt="Submit" type="submit" name="{Button_Name}" /><!-- END Button Button_Update -->
        <!-- BEGIN Button Button_Delete --><input id="SelectFormButton_Delete" value="Delete" alt="Delete" type="submit" name="{Button_Name}" /><!-- END Button Button_Delete --></td> 
    </tr>
 
  </table>
 
</form>
 <!-- END Record SelectForm -->
<br />
<div class="art-content-layout">
  <div class="art-layout-cell art-content">
        
    <h2 class="art-postheader">Distribución de Bancas</h2>
    <!-- <embed src="./svg/senadores.svg" width="450" height="300" type="image/svg+xml" style="border: .001cm solid black"/> -->
    <div id="seats"></div>
    <!-- style="display:none" -->
   </div>
  <!-- Content  53%-->
  <div class="art-layout-cell art-sidebar1">

<!-- BEGIN Grid Grid4 -->
<h2 class="art-postheader">Resumen General</h2>
 <br />
<table>
  <tr align="center">
    <th scope="col">Partido</th>
 
    <th scope="col"></th>
 
    <th scope="col">Votos</th>
 
    <th scope="col">Porciento</th>
 
    <th scope="col">Actual</th>
 
    <th scope="col">Previo</th>
 
    <th scope="col">Cambio</th>
 
  </tr>
 
  <!-- BEGIN Row -->
  <tr style="FONT-SIZE: 18px; FONT-WEIGHT: bold" class="bottomborder">
    <td style="WIDTH: 50px">{siglas}&nbsp;</td> 
    <td><img id="Grid4logo_{Grid4:rowNumber}" alt="{siglas}" src="{logo}" width="50" height="60" />&nbsp;</td> 
    <td style="TEXT-ALIGN: right; WIDTH: 125px">{votos}&nbsp;</td> 
    <td style="TEXT-ALIGN: right; WIDTH: 75px">{porciento}&nbsp;</td> 
    <td style="TEXT-ALIGN: right; WIDTH: 50px">{actual}&nbsp;</td> 
    <td style="TEXT-ALIGN: right; WIDTH: 50px">{previo}&nbsp;</td> 
    <td style="TEXT-ALIGN: right; WIDTH: 50px">{cambio}&nbsp;</td> 
  </tr>
 <!-- END Row -->
  <!-- BEGIN NoRecords -->
  <tr>
    <td colspan="7">No records</td> 
  </tr>
 <!-- END NoRecords -->
</table>
 <!-- END Grid Grid4 -->

<!-- BEGIN Grid Grid2 -->
<table style="FONT-SIZE: 18px">
  <!-- BEGIN Row -->
  <tr>
    <th style="WIDTH: 150px" scope="row">Votos</th>
 
    <td>{votos}&nbsp;</td> 
    <th style="WIDTH: 150px" scope="row">Inscritos</th>
 
    <td>{inscritos}&nbsp;</td> 
  </tr>
 
  <tr>
    <th scope="row">Participación</th>
 
    <td>{participacion}&nbsp;</td> 
    <th scope="row">Total Inscritos</th>
 
    <td>{totalinscritos}&nbsp;</td> 
  </tr>
 <!-- END Row -->
  <!-- BEGIN NoRecords -->
  <tr>
    <td colspan="2">No records</td> 
  </tr>
 <!-- END NoRecords -->
</table>
 <!-- END Grid Grid2 -->
    
  </div>
  <!-- Sidebar  47%-->
</div>
<!-- Layout  100%-->
<br />
<!-- BEGIN Grid Grid3 -->
<table width="100%">
  <!-- BEGIN Row -->
  <tr>
    <td style="TEXT-ALIGN: center; FONT-SIZE: 18px">{contados} mesas contadas de {colegios}&nbsp;para {porcientoContados}&nbsp;</td>
  </tr>
 <!-- END Row -->
  <!-- BEGIN NoRecords -->
  <tr>
    <td>No records</td>
  </tr>
  <!-- END NoRecords -->
</table>
<!-- END Grid Grid3 --><br />
{Footer}

<script src="bower_components/d3/d3.min.js" charset="utf-8"></script>
<script>

    function updateData(path, source) {
        function byId(result) {
            return result.id == this.id;
        }
        d3.json(source, function (error, result) {
            if (error) throw error;

            path.each(function() {
              try {
                  d3.select(this).attr("fill" , result.filter(byId, this)[0].winner);
              }
              catch(e) {
                  console.log(this.id);
              }
            });
        });
    }    

    d3.xml("svg/provincias.svg", "image/svg+xml", function(error, xml) {
        if (error) throw error;
        document.getElementById("map").appendChild(xml.documentElement);

        var svg = d3.select("#map svg")
            .attr("stroke", "#000000")
            .attr("width", "100%")
            .attr("height", 450);

        var path = svg.selectAll("path,polygon")
            .on("mouseover", function () {
                d3.select("text").text(this.attributes.getNamedItem("name").nodeValue); })
            .on("click", function () {
                window.location.href="SenadorDetalle.php?provincia=" + this.id; });

        updateData(path,"svg/provincias.php");
        window.mapUpdater = setInterval( function() {
            updateData(path,"svg/provincias.php");
        }, 30000);
        
    });

    d3.xml("svg/senadores.svg", "image/svg+xml", function(error, xml) {
        if (error) throw error;
        document.getElementById("seats").appendChild(xml.documentElement);

        var svg = d3.select("#seats svg")
            .attr("stroke", "#000000")
            .attr("width", 450)
            .attr("height", 300);

        var path = svg.selectAll("path");

        updateData(path, "svg/senadores.php");
        window.seatsUpdater = setInterval( function() {
            updateData(path,"svg/senadores.php");
        }, 30000);
    });

</script>

</body>
</html>